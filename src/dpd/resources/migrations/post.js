if (!internal)
    cancel('access denied', 500);